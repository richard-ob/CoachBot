<div class="container-fluid my-4">
    <!-- Team Latest Results -->
    <div class="card card--has-table">
        <div class="card__header card__header--has-btn">
            <h4>Players</h4>
            <!-- Result Filter -->
            <ul class="team-result-filter d-none d-md-inline float-right">
                <li class="team-result-filter__item">
                    <input type="text" class="form-control input-xs" placeholder="Player Name"
                        [(ngModel)]="filters.playerName">
                </li>
                <li class="team-result-filter__item">
                    <label class="checkbox checkbox-inline mr-2">
                        <input [(ngModel)]="filters.includeSubstituteAppearances" type="checkbox"
                            name="includeSubstituteAppearances"> Include Sub Appearances
                        <span class="checkbox-indicator"></span>
                    </label>
                </li>
                <li class="team-result-filter__item">
                    <select [(ngModel)]="filters.timePeriod" name="timePeriod" class="form-control" #timePeriodSelect>
                        <option [ngValue]="0">All Time</option>
                        <option [ngValue]="365">Year</option>
                        <option [ngValue]="31">Month</option>
                        <option [ngValue]="7">Week</option>
                    </select>
                </li>
                <li class="team-result-filter__item">
                    <button type="button" class="btn btn-outline-secondary btn-xs card-header__button"
                        (click)="setFilters()">
                        Filter
                    </button>
                </li>
            </ul>
            <!-- Result Filter / End -->
        </div>
        <div class="card__content table-responsive">
            <app-spinner *ngIf="isLoading"></app-spinner>
            <table *ngIf="!isLoading"
                class="table table--large table-striped table-hover table-clickable table-inner-border table-column-hover"
                [class.widget__content--loading]="isLoadingPage">
                <thead>
                    <tr>
                        <th class="team-result__vs" style="width: 40px;"></th>
                        <th sorter [sortByColumn]="'Name'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadPage(currentPage, $event)" class="no-left-border"></th>
                        <th class="text-center">Nationality</th>
                        <th sorter [sortByColumn]="'Rating'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadPage(currentPage, $event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'Appearances'" [sortByColumnName]="'Apps'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadPage(currentPage, $event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'SubstituteAppearances'" [sortByColumnName]="'As Sub'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadPage(currentPage, $event)"
                            class="text-center">
                        </th>
                        <th sorter [sortByColumn]="'Wins'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadPage(currentPage, $event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'Losses'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadPage(currentPage, $event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'Draws'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadPage(currentPage, $event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'Goals'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadPage(currentPage, $event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'GoalsAverage'" [sortByColumnName]="'Goals'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadPage(currentPage, $event)" class="text-center"
                            [average]="true">
                        </th>
                        <th sorter [sortByColumn]="'ShotAccuracyPercentage'" [sortByColumnName]="'Shot Accuracy'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadPage(currentPage, $event)"
                            class="text-center">
                        </th>
                        <th sorter [sortByColumn]="'Assists'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadPage(currentPage, $event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'AssistsAverage'" [sortByColumnName]="'Assists'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadPage(currentPage, $event)"
                            class="text-center" [average]="true">
                        </th>
                        <th sorter [sortByColumn]="'PassesAverage'" [sortByColumnName]="'Passes'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadPage(currentPage, $event)" class="text-center"
                            [average]="true">
                        </th>
                        <th sorter [sortByColumn]="'PassCompletionPercentageAverage'"
                            [sortByColumnName]="'Pass Completion'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadPage(currentPage, $event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'PossessionPercentageAverage'" [sortByColumnName]="'Possession'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadPage(currentPage, $event)"
                            class="text-center" [average]="true"></th>
                        <th sorter [sortByColumn]="'YellowCards'" [sortByColumnName]="'Yellows'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadPage(currentPage, $event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'RedCards'" [sortByColumnName]="'Reds'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadPage(currentPage, $event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'DistanceCoveredAverage'" [sortByColumnName]="'Avg. Distance'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadPage(currentPage, $event)"
                            class="text-center" [average]="true">
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let statistics of playerStatistics | paginate: { itemsPerPage: 10, currentPage: currentPage, totalItems: totalItems }; let odd = odd"
                        (click)="navigateToProfile(statistics.playerId)">
                        <td class="py-0 px-2" style="vertical-align: middle;">
                            <a *ngIf="statistics.steamUserProfile; else avatarSkeleton"
                                [attr.href]="statistics.steamUserProfile.profileurl">
                                <img [attr.src]="statistics.steamUserProfile.avatar"
                                    style="height: 16px; width: 16px; max-width: unset;">
                            </a>
                            <ng-template #avatarSkeleton>
                                <ngx-skeleton-loader class="mt-2" [animation]="odd ? 'progress' : 'progress-dark'"
                                    appearance="circle"
                                    [theme]="{ 'border-radius': '2px', 'height': '16px', 'width': '16px' }">
                                </ngx-skeleton-loader>
                            </ng-template>
                        </td>
                        <td class="no-left-border">{{statistics.name}}</td>
                        <td class="team-result__ball-posession text-center text-center py-0 px-2"
                            style="vertical-align: middle;">
                            <ng-container *ngIf="statistics.steamUserProfile; else flagSkeleton">
                                <img *ngIf="statistics.steamUserProfile.loccountrycode; else unknownFlag"
                                    src="https://www.countryflags.io/{{statistics.steamUserProfile.loccountrycode}}/flat/24.png">
                                <ng-template #unknownFlag><i class="fas fa-question"></i></ng-template>
                            </ng-container>
                            <ng-template #flagSkeleton>
                                <ngx-skeleton-loader class="mt-2" [animation]="odd ? 'progress' : 'progress-dark'"
                                    appearance="circle"
                                    [theme]="{ 'border-radius': '5px', 'height': '22px', 'width': '24px' }">
                                </ngx-skeleton-loader>
                            </ng-template>
                        </td>
                        <td class="team-result__status text-center">
                            <ng-container *ngIf="statistics.rating > 0; else notRated">
                                {{statistics.rating | number : '1.1-1'}}
                            </ng-container>
                            <ng-template #notRated>
                                N/A
                            </ng-template>
                        </td>
                        <td class="team-result__status text-center">{{statistics.appearances}}</td>
                        <td class="team-result__status text-center">{{statistics.substituteAppearances}}</td>
                        <td class="team-result__status text-center">{{statistics.wins}}</td>
                        <td class="team-result__status text-center">{{statistics.losses}}</td>
                        <td class="team-result__status text-center">{{statistics.draws}}</td>
                        <td class="team-result__status text-center">{{statistics.goals}}</td>
                        <td class="team-result__status text-center">{{statistics.goalsAverage | number : '1.2-2'}}</td>
                        <td class="team-result__status text-center">{{statistics.shotAccuracyPercentage | percent }}
                        </td>
                        <td class="team-result__status text-center">{{statistics.assists}}</td>
                        <td class="team-result__status text-center">{{statistics.assistsAverage | number : '1.2-2'}}
                        </td>
                        <td class="team-result__status text-center">{{statistics.passesAverage | number : '1.2-2'}}</td>
                        <td class="team-result__status text-center">
                            {{statistics.passCompletionPercentageAverage | percent }}
                        </td>
                        <td class="team-result__status text-center">
                            {{statistics.possessionPercentageAverage | percent }}
                        </td>
                        <td class="team-result__status text-center">{{statistics.yellowCards}}</td>
                        <td class="team-result__status text-center">{{statistics.redCards}}</td>
                        <td class="team-result__status text-center">
                            {{statistics.distanceCoveredAverage | number : '1.2-2'}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div *ngIf="!isLoading && totalPages > 1" class="text-center mb-4">
        <pagination-controls (pageChange)="loadPage($event)"></pagination-controls>
    </div>
</div>
<!-- Team Latest Results / End -->